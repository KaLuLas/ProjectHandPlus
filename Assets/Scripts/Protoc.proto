syntax="proto3";
package GameProto;

message Position{
	float x=1;
	float y=2;
	float z=3;
}


enum ServerEventCode {
	Fail = 0;
	Success = 2;
}

enum ClientEventCode {
	LogIn = 0;
	Regist = 1;
	EnterRoom = 2;
	Sync = 3;
	Follow = 4;
}

//玩家状态
message PlayerState{
	int32 fid=1;
	string name=2;
	float yaw=3;
	Position pos=4;
	int32 state=5;
}

//玩家一次操作
message PlayerInput{
	string name=1;
	float torque=2;
	bool grasp=3;
	bool attach=4;
}

//客户端数据包
//登录：type=0,name,password
//注册：type=1,name,password
//进房间：type=2,name,id=room_id
//同步：type=3,input
//追帧：type=4,name,id=fid
message ClientMsg{
	ClientEventCode type=1;
	string name=2;
	string password=3;
	int32 id=4;
	PlayerInput input=5;
}

//服务器数据包
//登录成功：code=0,str=ip:port
//注册成功：code=0
//进房间成功：code=0,fid=房间人数
//登录，注册，进房间失败：code=1,str
//同步：code=2,fid,inputs,(states?)
message ServerMsg{
	ServerEventCode type=1;
	int32 code=2;
	int32 fid=3;
	string str=4;
	repeated PlayerInput inputs=5;
	repeated PlayerState states=6;
}
